language: go

go:
  - 1.8.x
  - 1.9.x

env:
  global:
    - FASTDL=https://fastdl.mongodb.org/linux
  matrix:
    - MONGODB=x86_64-ubuntu1404-3.2.17
    - MONGODB=x86_64-ubuntu1404-3.4.10
    - MONGODB=x86_64-ubuntu1404-3.6.0

before_script: 
  - wget $FASTDL/mongodb-linux-$MONGODB.tgz
  - tar xzvf mongodb-linux-$MONGODB.tgz
  - export PATH=$PWD/mongodb-linux-$MONGODB/bin:$PATH
  - mkdir $PWD/db
  - mongod --dbpath $PWD/db > /dev/null &

  - go build 
  - go get github.com/golang/lint/golint
  - golint ./... 
  - go vet ./...

script:
  - ./test.sh
  - ./mgodatagen -f samples/config.json
  - ./mgodatagen -f samples/agg.json
  
after_success:
  - bash <(curl -s https://codecov.io/bash)

notifications: 
  email: false

git:
  depth: 3
